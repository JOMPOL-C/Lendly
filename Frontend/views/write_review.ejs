<%- include('includes/head') %>
    <link rel="stylesheet" href="/styles/rental.css">
    <link rel="stylesheet" href="/styles/review.css">
    </head>

    <body>
        <%- include('includes/nav') %>
            <main>
                <section class="index">
                    <h2>เขียนรีวิวสินค้า</h2>

                    <% if (rentals.length===0) { %>
                        <p style="text-align:center; color:#777;">ยังไม่มีสินค้าที่คืนแล้วสำหรับการรีวิว</p>
                        <% } else { %>
                            <% rentals.forEach(rental=> { %>
                                <div class="rental-card">
                                    <img src="<%= rental.product.images[0]?.image_url || '/images/no-image.png' %>"
                                        alt="Product Image">
                                    <div class="rental-info">
                                        <h3>
                                            <%= rental.product.product_name %>
                                        </h3>
                                        <p>วันที่เช่า:
                                            <%= rental.rental_date ? new
                                                Date(rental.rental_date).toLocaleDateString('th-TH') : '-' %>
                                        </p>
                                        <p>วันที่คืน:
                                            <%= rental.rental_end_date ? new
                                                Date(rental.rental_end_date).toLocaleDateString('th-TH') : '-' %>
                                        </p>

                                        <p>ราคาค่าเช่า: <%= rental.product.price %>฿</p>

                                        <form action="/api/orders/review" method="POST" enctype="multipart/form-data"
                                            class="review-form">
                                            <div class="form-group">
                                                <label for="reviewText">ข้อความรีวิว</label>
                                                <textarea name="reviewText" rows="3" required
                                                    placeholder="เล่าประสบการณ์การเช่า เช่น คุณภาพสินค้า การจัดส่ง ฯลฯ"></textarea>
                                            </div>

                                            <div class="form-group">
                                                <label for="reviewImages">อัปโหลดรูป (ถ้ามี)</label>
                                                <input type="file" name="reviewImages" accept="image/*" multiple>
                                            </div>

                                            <input type="hidden" name="productId"
                                                value="<%= rental.product.product_id %>">
                                            <input type="hidden" name="rentalId" value="<%= rental.rental_id %>">

                                            <button type="submit" class="submit-btn">ส่งรีวิว</button>
                                        </form>
                                    </div>
                                </div>
                                <% }) %>
                                    <% } %>
                </section>
            </main>
            <%- include('includes/footer') %>
                <%- include('includes/chatWidget') %>
                    <script src="/js/script.js"></script>
    </body>

    </html>